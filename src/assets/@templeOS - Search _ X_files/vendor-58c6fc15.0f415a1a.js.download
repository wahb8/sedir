window.__SCRIPTS_LOADED__.runtime&&((self.webpackChunk_twitter_responsive_web=self.webpackChunk_twitter_responsive_web||[]).push([["vendor-58c6fc15"],{719813:(e,t,i)=>{var s=i(183491).default,o=s(i(158663)),n=s(i(434323)),r=i(408122),a=i(91650),l=i(471677),u=i(770196),c=i(891362),p=i(795178).stableCopy,d=i(313802),_=i(286190),h=_.generateClientID,f=_.generateUniqueClientID,m=i(700378).getLocalVariables,v=i(705180),g=i(464711),P=g.createNormalizationSelector,y=g.createReaderSelector,I=i(887428),b=i(108475),S=b.ROOT_TYPE,D=b.TYPENAME_KEY,A=b.getStorageKey,w=i(647677);i(826590);var k=function(){function e(e){var t=this,i=e.actorIdentifier,s=e.getDataID,o=e.getPublishQueue,n=e.getStore,r=e.isClientPayload,l=e.operation,u=e.operationExecutions,p=e.operationLoader,d=e.operationTracker,_=e.optimisticConfig,h=e.scheduler,f=e.shouldProcessClientComponents,m=e.sink,v=e.source,g=e.treatMissingFieldsAsNull,P=e.updater,y=e.log,I=e.normalizeResponse;this._actorIdentifier=i,this._getDataID=s,this._treatMissingFieldsAsNull=g,this._incrementalPayloadsPending=!1,this._incrementalResults=new Map,this._log=y,this._executeId=a(),this._nextSubscriptionId=0,this._operation=l,this._operationExecutions=u,this._operationLoader=p,this._operationTracker=d,this._operationUpdateEpochs=new Map,this._optimisticUpdates=null,this._pendingModulePayloadsCount=0,this._getPublishQueue=o,this._scheduler=h,this._sink=m,this._source=new Map,this._state="started",this._getStore=n,this._subscriptions=new Map,this._updater=P,this._isClientPayload=!0===r,this._isSubscriptionOperation="subscription"===this._operation.request.node.params.operationKind,this._shouldProcessClientComponents=f,this._retainDisposables=new Map,this._seenActors=new Set,this._completeFns=[],this._normalizeResponse=I;var b=this._nextSubscriptionId++;c.PROCESS_OPTIMISTIC_UPDATE_BEFORE_SUBSCRIPTION&&null!=_&&this._processOptimisticResponse(null!=_.response?{data:_.response}:null,_.updater,!1),v.subscribe({complete:function(){return t._complete(b)},error:function(e){return t._error(e)},next:function(e){try{t._next(b,e)}catch(e){m.error(e)}},start:function(e){var i;t._start(b,e),t._log({name:"execute.start",executeId:t._executeId,params:t._operation.request.node.params,variables:t._operation.request.variables,cacheConfig:null!==(i=t._operation.request.cacheConfig)&&void 0!==i?i:{}})}}),c.PROCESS_OPTIMISTIC_UPDATE_BEFORE_SUBSCRIPTION||null==_||this._processOptimisticResponse(null!=_.response?{data:_.response}:null,_.updater,!1)}var t=e.prototype;return t.cancel=function(){var e=this;if("completed"!==this._state){this._state="completed",this._operationExecutions.delete(this._operation.request.identifier),0!==this._subscriptions.size&&(this._subscriptions.forEach((function(e){return e.unsubscribe()})),this._subscriptions.clear());var t=this._optimisticUpdates;null!==t&&(this._optimisticUpdates=null,t.forEach((function(t){return e._getPublishQueueAndSaveActor().revertUpdate(t)})),this._runPublishQueue()),this._incrementalResults.clear(),null!=this._asyncStoreUpdateDisposable&&(this._asyncStoreUpdateDisposable.dispose(),this._asyncStoreUpdateDisposable=null),this._completeFns=[],this._completeOperationTracker(),this._disposeRetainedData()}},t._updateActiveState=function(){var e;switch(this._state){case"started":case"loading_incremental":e="active";break;case"completed":e="inactive";break;case"loading_final":e=this._pendingModulePayloadsCount>0?"active":"inactive";break;default:this._state,w(!1)}this._operationExecutions.set(this._operation.request.identifier,e)},t._schedule=function(e,t){var i=this,s=this._scheduler;if(null!=s){var o=this._nextSubscriptionId++;r.create((function(i){var o=s.schedule((function(){try{e(),i.complete()}catch(e){i.error(e)}}),t);return function(){return s.cancel(o)}})).subscribe({complete:function(){return i._complete(o)},error:function(e){return i._error(e)},start:function(e){return i._start(o,e)}})}else e()},t._complete=function(e){this._subscriptions.delete(e),0===this._subscriptions.size&&(this.cancel(),this._sink.complete(),this._log({name:"execute.complete",executeId:this._executeId}))},t._error=function(e){this.cancel(),this._sink.error(e),this._log({name:"execute.error",executeId:this._executeId,error:e})},t._start=function(e,t){this._subscriptions.set(e,t),this._updateActiveState()},t._next=function(e,t){var i=this,s="loading_incremental"===this._state?"low":"default";this._schedule((function(){i._log({name:"execute.next.start",executeId:i._executeId,response:t,operation:i._operation}),i._handleNext(t),i._maybeCompleteSubscriptionOperationTracking(),i._log({name:"execute.next.end",executeId:i._executeId,response:t,operation:i._operation})}),s)},t._handleErrorResponse=function(e){var t=this,i=[];return e.forEach((function(e){if(null!==e.data||null==e.extensions||e.hasOwnProperty("errors")){if(null==e.data){var s=e.hasOwnProperty("errors")&&null!=e.errors?e.errors:null,o=s?s.map((function(e){return e.message})).join("\n"):"(No errors)",n=u.create("RelayNetwork","No data returned for operation `"+t._operation.request.node.params.name+"`, got error(s):\n"+o+"\n\nSee the error `source` property for more information.");throw n.source={errors:s,operation:t._operation.request.node,variables:t._operation.request.variables},n.stack,n}var r=e;i.push(r)}})),i},t._handleOptimisticResponses=function(e){var t;if(e.length>1)return e.some((function(e){var t;return!0===(null===(t=e.extensions)||void 0===t?void 0:t.isOptimistic)}))&&w(!1),!1;var i=e[0],s=!0===(null===(t=i.extensions)||void 0===t?void 0:t.isOptimistic);return s&&"started"!==this._state&&w(!1),!!s&&(this._processOptimisticResponse(i,null,this._treatMissingFieldsAsNull),this._sink.next(i),!0)},t._handleNext=function(e){if("completed"!==this._state){this._seenActors.clear();var t=Array.isArray(e)?e:[e],i=this._handleErrorResponse(t);if(0===i.length)return t.some((function(e){var t;return!0===(null===(t=e.extensions)||void 0===t?void 0:t.is_final)}))&&(this._state="loading_final",this._updateActiveState(),this._incrementalPayloadsPending=!1),void this._sink.next(e);if(!this._handleOptimisticResponses(i)){var s=function(e){var t=[],i=[];return e.forEach((function(e){if(null!=e.path||null!=e.label){var s=e.label,o=e.path;null!=s&&null!=o||w(!1),i.push({label:s,path:o,response:e})}else t.push(e)})),[t,i]}(i),o=s[0],n=s[1],r=o.length>0;if(r){if(this._isSubscriptionOperation){var a=f();this._operation={request:this._operation.request,fragment:y(this._operation.fragment.node,a,this._operation.fragment.variables,this._operation.fragment.owner),root:P(this._operation.root.node,a,this._operation.root.variables)}}var l=this._processResponses(o);this._processPayloadFollowups(l)}if(n.length>0){var u=this._processIncrementalResponses(n);this._processPayloadFollowups(u)}this._isSubscriptionOperation&&(null==i[0].extensions?i[0].extensions={__relay_subscription_root_id:this._operation.fragment.dataID}:i[0].extensions.__relay_subscription_root_id=this._operation.fragment.dataID);var c=this._runPublishQueue(r?this._operation:void 0);r&&this._incrementalPayloadsPending&&this._retainData(),this._updateOperationTracker(c),this._sink.next(e)}}},t._processOptimisticResponse=function(e,t,i){var s=this;if(null!==this._optimisticUpdates&&w(!1),null!=e||null!=t){var o=[];if(e){var n=this._normalizeResponse(e,this._operation.root,S,{actorIdentifier:this._actorIdentifier,getDataID:this._getDataID,path:[],shouldProcessClientComponents:this._shouldProcessClientComponents,treatMissingFieldsAsNull:i});x(n),o.push({operation:this._operation,payload:n,updater:t}),this._processOptimisticFollowups(n,o)}else t&&o.push({operation:this._operation,payload:{errors:null,fieldPayloads:null,incrementalPlaceholders:null,followupPayloads:null,source:I.create(),isFinal:!1},updater:t});this._optimisticUpdates=o,o.forEach((function(e){return s._getPublishQueueAndSaveActor().applyUpdate(e)}));var r=this._runPublishQueue();c.ENABLE_OPERATION_TRACKER_OPTIMISTIC_UPDATES&&this._updateOperationTracker(r)}},t._processOptimisticFollowups=function(e,t){if(e.followupPayloads&&e.followupPayloads.length){var i,s=e.followupPayloads,r=(0,o.default)(s);try{for(r.s();!(i=r.n()).done;){var a=i.value;switch(a.kind){case"ModuleImportPayload":var l=this._expectOperationLoader().get(a.operationReference);if(null==l)this._processAsyncOptimisticModuleImport(a);else{var u=this._processOptimisticModuleImport(l,a);t.push.apply(t,(0,n.default)(u))}break;case"ActorPayload":break;default:w(!1)}}}catch(e){r.e(e)}finally{r.f()}}},t._normalizeFollowupPayload=function(e,t){var i;i="SplitOperation"===t.kind&&"ModuleImportPayload"===e.kind?m(e.variables,t.argumentDefinitions,e.args):e.variables;var s=P(t,e.dataID,i);return this._normalizeResponse({data:e.data},s,e.typeName,{actorIdentifier:this._actorIdentifier,getDataID:this._getDataID,path:e.path,treatMissingFieldsAsNull:this._treatMissingFieldsAsNull,shouldProcessClientComponents:this._shouldProcessClientComponents})},t._processOptimisticModuleImport=function(e,t){var i=l(e),s=[],o=this._normalizeFollowupPayload(t,i);return x(o),s.push({operation:this._operation,payload:o,updater:null}),this._processOptimisticFollowups(o,s),s},t._processAsyncOptimisticModuleImport=function(e){var t=this;this._expectOperationLoader().load(e.operationReference).then((function(i){if(null!=i&&"started"===t._state){var s,o=t._processOptimisticModuleImport(i,e);if(o.forEach((function(e){return t._getPublishQueueAndSaveActor().applyUpdate(e)})),null==t._optimisticUpdates);else(s=t._optimisticUpdates).push.apply(s,(0,n.default)(o)),t._runPublishQueue()}}))},t._processResponses=function(e){var t=this;return this._log({name:"execute.normalize.start",operation:this._operation}),null!==this._optimisticUpdates&&(this._optimisticUpdates.forEach((function(e){t._getPublishQueueAndSaveActor().revertUpdate(e)})),this._optimisticUpdates=null),this._incrementalPayloadsPending=!1,this._incrementalResults.clear(),this._source.clear(),e.map((function(e){var i=t._normalizeResponse(e,t._operation.root,S,{actorIdentifier:t._actorIdentifier,getDataID:t._getDataID,path:[],treatMissingFieldsAsNull:t._treatMissingFieldsAsNull,shouldProcessClientComponents:t._shouldProcessClientComponents});return t._getPublishQueueAndSaveActor().commitPayload(t._operation,i,t._updater),t._log({name:"execute.normalize.end",operation:t._operation}),i}))},t._processPayloadFollowups=function(e){var t=this;"completed"!==this._state&&e.forEach((function(e){var i=e.incrementalPlaceholders,s=e.followupPayloads,o=e.isFinal;if(t._state=o?"loading_final":"loading_incremental",t._updateActiveState(),o&&(t._incrementalPayloadsPending=!1),s&&0!==s.length&&s.forEach((function(e){var i,s=t._actorIdentifier;t._actorIdentifier=null!==(i=e.actorIdentifier)&&void 0!==i?i:t._actorIdentifier,t._processFollowupPayload(e),t._actorIdentifier=s})),i&&0!==i.length&&(t._incrementalPayloadsPending="loading_final"!==t._state,i.forEach((function(i){var s,o=t._actorIdentifier;t._actorIdentifier=null!==(s=i.actorIdentifier)&&void 0!==s?s:t._actorIdentifier,t._processIncrementalPlaceholder(e,i),t._actorIdentifier=o})),t._isClientPayload||"loading_final"===t._state)){var n=[];i.forEach((function(e){"defer"===e.kind&&n.push(t._processDeferResponse(e.label,e.path,e,{data:e.data}))})),n.length>0&&t._processPayloadFollowups(n)}}))},t._maybeCompleteSubscriptionOperationTracking=function(){this._isSubscriptionOperation&&0===this._pendingModulePayloadsCount&&!1===this._incrementalPayloadsPending&&this._completeOperationTracker()},t._processFollowupPayload=function(e){var t=this;switch(e.kind){case"ModuleImportPayload":var i=this._expectOperationLoader(),s=i.get(e.operationReference);if(null!=s)this._processFollowupPayloadWithNormalizationNode(e,l(s));else{var o=this._nextSubscriptionId++;this._pendingModulePayloadsCount++;var n=function(){t._pendingModulePayloadsCount--,t._maybeCompleteSubscriptionOperationTracking()},a=r.from(new Promise((function(t,s){i.load(e.operationReference).then(t,s)})));r.create((function(i){var s,o=a.subscribe({next:function(o){if(null!=o){var n=function(){try{var s=l(o),n=c.BATCH_ASYNC_MODULE_UPDATES_FN,r=null!=n&&t._pendingModulePayloadsCount>1,a=d((function(){if(t._handleFollowupPayload(e,s),r)t._scheduleAsyncStoreUpdate(n,i.complete);else{var o=t._runPublishQueue();t._updateOperationTracker(o)}})),u=(a[0],a[1]);t._log({name:"execute.async.module",executeId:t._executeId,operationName:s.name,duration:u}),r||i.complete()}catch(e){i.error(e)}},r=t._scheduler;null==r?n():s=r.schedule(n)}else i.complete()},error:i.error});return function(){o.unsubscribe(),null!=t._scheduler&&null!=s&&t._scheduler.cancel(s)}})).subscribe({complete:function(){t._complete(o),n()},error:function(e){t._error(e),n()},start:function(e){return t._start(o,e)}})}break;case"ActorPayload":this._processFollowupPayloadWithNormalizationNode(e,e.node);break;default:w(!1)}},t._processFollowupPayloadWithNormalizationNode=function(e,t){this._handleFollowupPayload(e,t),this._maybeCompleteSubscriptionOperationTracking()},t._handleFollowupPayload=function(e,t){var i=this._normalizeFollowupPayload(e,t);this._getPublishQueueAndSaveActor().commitPayload(this._operation,i),this._processPayloadFollowups([i])},t._processIncrementalPlaceholder=function(e,t){var i,s=t.label,o=t.path.map(String).join("."),n=this._incrementalResults.get(s);null==n&&(n=new Map,this._incrementalResults.set(s,n));var r,a=n.get(o),l=null!=a&&"response"===a.kind?a.responses:null;n.set(o,{kind:"placeholder",placeholder:t}),"stream"===t.kind?r=t.parentID:"defer"===t.kind?r=t.selector.dataID:w(!1);var u,c,d=e.source.get(r),_=(null!==(i=e.fieldPayloads)&&void 0!==i?i:[]).filter((function(e){var t=h(e.dataID,e.fieldKey);return e.dataID===r||t===r}));null==d&&w(!1);var f=this._source.get(r);if(null!=f){u=v.update(f.record,d);var m=new Map,g=function(e){var t,i,s=(t=e,null!==(i=JSON.stringify(p(t)))&&void 0!==i?i:"");m.set(s,e)};f.fieldPayloads.forEach(g),_.forEach(g),c=Array.from(m.values())}else u=d,c=_;if(this._source.set(r,{record:u,fieldPayloads:c}),null!=l){var P=this._processIncrementalResponses(l);this._processPayloadFollowups(P)}},t._processIncrementalResponses=function(e){var t=this,i=[];return e.forEach((function(e){var s=e.label,o=e.path,n=e.response,r=t._incrementalResults.get(s);if(null==r&&(r=new Map,t._incrementalResults.set(s,r)),-1!==s.indexOf("$defer$")){var a=o.map(String).join("."),l=r.get(a);if(null==l)return l={kind:"response",responses:[e]},void r.set(a,l);if("response"===l.kind)return void l.responses.push(e);var u=l.placeholder;"defer"!==u.kind&&w(!1),i.push(t._processDeferResponse(s,o,u,n))}else{var c=o.slice(0,-2).map(String).join("."),p=r.get(c);if(null==p)return p={kind:"response",responses:[e]},void r.set(c,p);if("response"===p.kind)return void p.responses.push(e);var d=p.placeholder;"stream"!==d.kind&&w(!1),i.push(t._processStreamResponse(s,o,d,n))}})),i},t._processDeferResponse=function(e,t,i,s){var o,n=i.selector.dataID,r=this._actorIdentifier;this._actorIdentifier=null!==(o=i.actorIdentifier)&&void 0!==o?o:this._actorIdentifier;var a=this._normalizeResponse(s,i.selector,i.typeName,{actorIdentifier:this._actorIdentifier,getDataID:this._getDataID,path:i.path,treatMissingFieldsAsNull:this._treatMissingFieldsAsNull,shouldProcessClientComponents:this._shouldProcessClientComponents});this._getPublishQueueAndSaveActor().commitPayload(this._operation,a);var l=this._source.get(n);null==l&&w(!1);var u=l.fieldPayloads;if(0!==u.length){var c,p={errors:null,fieldPayloads:u,incrementalPlaceholders:null,followupPayloads:null,source:I.create(),isFinal:!0===(null===(c=s.extensions)||void 0===c?void 0:c.is_final)};this._getPublishQueueAndSaveActor().commitPayload(this._operation,p)}return this._actorIdentifier=r,a},t._processStreamResponse=function(e,t,i,s){var o=i.parentID,r=i.node,a=i.variables,l=i.actorIdentifier,u=this._actorIdentifier;this._actorIdentifier=null!=l?l:this._actorIdentifier;var c=r.selections[0];(null==c||"LinkedField"!==c.kind||!0!==c.plural)&&w(!1);var p=this._normalizeStreamItem(s,o,c,a,t,i.path),d=p.fieldPayloads,_=p.itemID,h=p.itemIndex,f=p.prevIDs,m=p.relayPayload,v=p.storageKey;if(this._getPublishQueueAndSaveActor().commitPayload(this._operation,m,(function(e){var t=e.get(o);if(null!=t){var i=t.getLinkedRecords(v);if(null!=i&&i.length===f.length&&!i.some((function(e,t){return f[t]!==(e&&e.getDataID())}))){var s=(0,n.default)(i);s[h]=e.get(_),t.setLinkedRecords(s,v)}}})),0!==d.length){var g={errors:null,fieldPayloads:d,incrementalPlaceholders:null,followupPayloads:null,source:I.create(),isFinal:!1};this._getPublishQueueAndSaveActor().commitPayload(this._operation,g)}return this._actorIdentifier=u,m},t._normalizeStreamItem=function(e,t,i,s,o,r){var a,l,u,c,p=e.data;"object"!=typeof p&&w(!1);var d=null!==(a=i.alias)&&void 0!==a?a:i.name,_=A(i,s),f=this._source.get(t);null==f&&w(!1);var m=f.record,g=f.fieldPayloads,y=v.getLinkedRecordIDs(m,_);null==y&&w(!1);var I=o[o.length-1],b=parseInt(I,10);b===I&&b>=0||w(!1);var S=null!==(l=i.concreteType)&&void 0!==l?l:p[D];"string"!=typeof S&&w(!1);var k=null!==(u=null!==(c=this._getDataID(p,S))&&void 0!==c?c:null==y?void 0:y[b])&&void 0!==u?u:h(t,_,b);"string"!=typeof k&&w(!1);var x=P(i,k,s),C=v.clone(m),O=(0,n.default)(y);return O[b]=k,v.setLinkedRecordIDs(C,_,O),this._source.set(t,{record:C,fieldPayloads:g}),{fieldPayloads:g,itemID:k,itemIndex:b,prevIDs:y,relayPayload:this._normalizeResponse(e,x,S,{actorIdentifier:this._actorIdentifier,getDataID:this._getDataID,path:[].concat((0,n.default)(r),[d,String(b)]),treatMissingFieldsAsNull:this._treatMissingFieldsAsNull,shouldProcessClientComponents:this._shouldProcessClientComponents}),storageKey:_}},t._scheduleAsyncStoreUpdate=function(e,t){var i=this;this._completeFns.push(t),null==this._asyncStoreUpdateDisposable&&(this._asyncStoreUpdateDisposable=e((function(){i._asyncStoreUpdateDisposable=null;var e=i._runPublishQueue();i._updateOperationTracker(e);var t,s=(0,o.default)(i._completeFns);try{for(s.s();!(t=s.n()).done;){(0,t.value)()}}catch(e){s.e(e)}finally{s.f()}i._completeFns=[]})))},t._updateOperationTracker=function(e){null!=e&&e.length>0&&this._operationTracker.update(this._operation.request,new Set(e))},t._completeOperationTracker=function(){this._operationTracker.complete(this._operation.request)},t._getPublishQueueAndSaveActor=function(){return this._seenActors.add(this._actorIdentifier),this._getPublishQueue(this._actorIdentifier)},t._getActorsToVisit=function(){return 0===this._seenActors.size?new Set([this._actorIdentifier]):this._seenActors},t._runPublishQueue=function(e){var t,i=new Set,s=(0,o.default)(this._getActorsToVisit());try{for(s.s();!(t=s.n()).done;){var n=t.value;this._getPublishQueue(n).run(e).forEach((function(e){return i.add(e)}))}}catch(e){s.e(e)}finally{s.f()}return Array.from(i)},t._retainData=function(){var e,t=(0,o.default)(this._getActorsToVisit());try{for(t.s();!(e=t.n()).done;){var i=e.value;this._retainDisposables.has(i)||this._retainDisposables.set(i,this._getStore(i).retain(this._operation))}}catch(e){t.e(e)}finally{t.f()}},t._disposeRetainedData=function(){var e,t=(0,o.default)(this._retainDisposables.values());try{for(t.s();!(e=t.n()).done;){e.value.dispose()}}catch(e){t.e(e)}finally{t.f()}this._retainDisposables.clear()},t._expectOperationLoader=function(){var e=this._operationLoader;return e||w(!1),e},e}();function x(e){var t=e.incrementalPlaceholders;null!=t&&0!==t.length&&w(!1)}e.exports={execute:function(e){return new k(e)}}}}]),window.__SCRIPTS_LOADED__.vendor=!0);
//# sourceMappingURL=https://ton.local.twitter.com/responsive-web-internal/sourcemaps/client-web/vendor-58c6fc15.0f415a1a.js.map